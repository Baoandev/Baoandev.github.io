<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.127.0">
    <meta name="description" content="">
<meta name="author" content="journeyoftheaverageguy@gmail.com">

    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>Data Validation and ETL :: Bao An Thai</title>

    
    <link href="/css/nucleus.css?1726578020" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1726578020" rel="stylesheet">
    <link href="/css/hybrid.css?1726578020" rel="stylesheet">
    <link href="/css/featherlight.min.css?1726578020" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1726578020" rel="stylesheet">
    <link href="/css/auto-complete.css?1726578020" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1726578020" rel="stylesheet">
    <link href="/css/theme.css?1726578020" rel="stylesheet">
    <link href="/css/hugo-theme.css?1726578020" rel="stylesheet">
    
    <link href="/css/theme-workshop.css?1726578020" rel="stylesheet">
    
    

    <script src="/js/jquery-3.3.1.min.js?1726578020"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/4-transformingdatawithglue/4.1-datavalidationandetl/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="/">

<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 30" width="30%"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#f90;fill-rule:evenodd;}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09,10.85a4.7,4.7,0,0,0,.19,1.48,7.73,7.73,0,0,0,.54,1.19.77.77,0,0,1,.12.38.64.64,0,0,1-.32.49l-1,.7a.83.83,0,0,1-.44.15.69.69,0,0,1-.49-.23,3.8,3.8,0,0,1-.6-.77q-.25-.42-.51-1a6.14,6.14,0,0,1-4.89,2.3,4.54,4.54,0,0,1-3.32-1.19,4.27,4.27,0,0,1-1.22-3.2A4.28,4.28,0,0,1,3.61,7.75,6.06,6.06,0,0,1,7.69,6.46a12.47,12.47,0,0,1,1.76.13q.92.13,1.91.36V5.73a3.65,3.65,0,0,0-.79-2.66A3.81,3.81,0,0,0,7.86,2.3a7.71,7.71,0,0,0-1.79.22,12.78,12.78,0,0,0-1.79.57,4.55,4.55,0,0,1-.58.22l-.26,0q-.35,0-.35-.52V2a1.09,1.09,0,0,1,.12-.58,1.2,1.2,0,0,1,.47-.35A10.88,10.88,0,0,1,5.77.32,10.19,10.19,0,0,1,8.36,0a6,6,0,0,1,4.35,1.35,5.49,5.49,0,0,1,1.38,4.09ZM7.34,13.38a5.36,5.36,0,0,0,1.72-.31A3.63,3.63,0,0,0,10.63,12,2.62,2.62,0,0,0,11.19,11a5.63,5.63,0,0,0,.16-1.44v-.7a14.35,14.35,0,0,0-1.53-.28,12.37,12.37,0,0,0-1.56-.1,3.84,3.84,0,0,0-2.47.67A2.34,2.34,0,0,0,5,11a2.35,2.35,0,0,0,.61,1.76A2.4,2.4,0,0,0,7.34,13.38Zm13.35,1.8a1,1,0,0,1-.64-.16,1.3,1.3,0,0,1-.35-.65L15.81,1.51a3,3,0,0,1-.15-.67.36.36,0,0,1,.41-.41H17.7a1,1,0,0,1,.65.16,1.4,1.4,0,0,1,.33.65l2.79,11,2.59-11A1.17,1.17,0,0,1,24.39.6a1.1,1.1,0,0,1,.67-.16H26.4a1.1,1.1,0,0,1,.67.16,1.17,1.17,0,0,1,.32.65L30,12.39,32.88,1.25A1.39,1.39,0,0,1,33.22.6a1,1,0,0,1,.65-.16h1.54a.36.36,0,0,1,.41.41,1.36,1.36,0,0,1,0,.26,3.64,3.64,0,0,1-.12.41l-4,12.86a1.3,1.3,0,0,1-.35.65,1,1,0,0,1-.64.16H29.25a1,1,0,0,1-.67-.17,1.26,1.26,0,0,1-.32-.67L25.67,3.64,23.11,14.34a1.26,1.26,0,0,1-.32.67,1,1,0,0,1-.67.17Zm21.36.44a11.28,11.28,0,0,1-2.56-.29,7.44,7.44,0,0,1-1.92-.67,1,1,0,0,1-.61-.93v-.84q0-.52.38-.52a.9.9,0,0,1,.31.06l.42.17a8.77,8.77,0,0,0,1.83.58,9.78,9.78,0,0,0,2,.2,4.48,4.48,0,0,0,2.43-.55,1.76,1.76,0,0,0,.86-1.57,1.61,1.61,0,0,0-.45-1.16A4.29,4.29,0,0,0,43,9.22l-2.41-.76A5.15,5.15,0,0,1,38,6.78a3.94,3.94,0,0,1-.83-2.41,3.7,3.7,0,0,1,.45-1.85,4.47,4.47,0,0,1,1.19-1.37A5.27,5.27,0,0,1,40.51.29,7.4,7.4,0,0,1,42.6,0a8.87,8.87,0,0,1,1.12.07q.57.07,1.08.19t.95.26a4.27,4.27,0,0,1,.7.29,1.59,1.59,0,0,1,.49.41.94.94,0,0,1,.15.55v.79q0,.52-.38.52a1.76,1.76,0,0,1-.64-.2,7.74,7.74,0,0,0-3.2-.64,4.37,4.37,0,0,0-2.21.47,1.6,1.6,0,0,0-.79,1.48,1.58,1.58,0,0,0,.49,1.18,4.94,4.94,0,0,0,1.83.92L44.55,7a5.08,5.08,0,0,1,2.57,1.6A3.76,3.76,0,0,1,47.9,11a4.21,4.21,0,0,1-.44,1.93,4.4,4.4,0,0,1-1.21,1.47,5.43,5.43,0,0,1-1.85.93A8.25,8.25,0,0,1,42.05,15.62Z"></path><path class="cls-2" d="M45.19,23.81C39.72,27.85,31.78,30,25,30A36.64,36.64,0,0,1,.22,20.57c-.51-.46-.06-1.09.56-.74A49.78,49.78,0,0,0,25.53,26.4,49.23,49.23,0,0,0,44.4,22.53C45.32,22.14,46.1,23.14,45.19,23.81Z"></path><path class="cls-2" d="M47.47,21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74,3.13-2.2,8.27-1.57,8.86-.83s-.16,5.89-3.09,8.35c-.45.38-.88.18-.68-.32C46.69,25.8,48.17,22.11,47.47,21.21Z"></path></svg>

</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1726578020"></script>
<script type="text/javascript" src="/js/auto-complete.js?1726578020"></script>
<script type="text/javascript">
    
        var baseurl = "http:\/\/baoandev.github.io\/";
    
</script>
<script type="text/javascript" src="/js/search.js?1726578020"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/1-introduce/" title="Introduction" class="dd-item 
        
        
        
        ">
      <a href="/1-introduce/">
           <b> 1. </b> Introduction
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/2-realtime/" title="Real-Time Clickstream Anomaly Detection with Amazon Managed Service for Apache Flink " class="dd-item 
        
        
        
        ">
      <a href="/2-realtime/">
           <b> 2. </b> Real-Time Clickstream Anomaly Detection with Amazon Managed Service for Apache Flink 
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/2-realtime/2.1-realtimesetup/" title="Real-Time Clickstream Anomaly Detection with Amazon Managed Service for Apache Flink Prelab setup" class="dd-item 
        
        
        
        ">
      <a href="/2-realtime/2.1-realtimesetup/">
           <b> 2.1 </b> Real-Time Clickstream Anomaly Detection with Amazon Managed Service for Apache Flink Prelab setup
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-realtime/2.2-lab/" title="Lab: Real-Time Clickstream Anomaly Detection with Amazon Managed Service for Apache Flink" class="dd-item 
        
        
        
        ">
      <a href="/2-realtime/2.2-lab/">
           <b> 2.2 </b> Lab: Real-Time Clickstream Anomaly Detection with Amazon Managed Service for Apache Flink
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-realtime/2.3-labglue/" title="Lab: Streaming ETL with Glue" class="dd-item 
        
        
        
        ">
      <a href="/2-realtime/2.3-labglue/">
           <b> 2.3 </b> Lab: Streaming ETL with Glue
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/3-ingestion/" title="Ingestion with DMS" class="dd-item 
        
        
        
        ">
      <a href="/3-ingestion/">
           <b> 3. </b> Ingestion with DMS
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/3-ingestion/3.1-skipdms/" title="Option 3: Skip DMS" class="dd-item 
        
        
        
        ">
      <a href="/3-ingestion/3.1-skipdms/">
           <b> 3.1 </b> Option 3: Skip DMS
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/4-transformingdatawithglue/" title="Transforming data with Glue" class="dd-item 
        parent
        
        
        ">
      <a href="/4-transformingdatawithglue/">
           <b> 4. </b> Transforming data with Glue
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/4-transformingdatawithglue/4.1-datavalidationandetl/" title="Data Validation and ETL" class="dd-item 
        
        active
        
        ">
      <a href="/4-transformingdatawithglue/4.1-datavalidationandetl/">
           <b> 4.1 </b> Data Validation and ETL
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/5-queryandvisualize/" title="Query and Visualize" class="dd-item 
        
        
        
        ">
      <a href="/5-queryandvisualize/">
           <b> 5. </b> Query and Visualize
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/5-queryandvisualize/5.1-athenaandquicksight/" title="Athena and Quicksight" class="dd-item 
        
        
        
        ">
      <a href="/5-queryandvisualize/5.1-athenaandquicksight/">
           <b> 5.1 </b> Athena and Quicksight
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/7-gluedatabrew/" title="Glue DataBrew" class="dd-item 
        
        
        
        ">
      <a href="/7-gluedatabrew/">
           <b> 6. </b> Glue DataBrew
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/7-gluedatabrew/7.1-prelab/" title="DataBrew Prelab" class="dd-item 
        
        
        
        ">
      <a href="/7-gluedatabrew/7.1-prelab/">
           <b> 6.1 </b> DataBrew Prelab
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/7-gluedatabrew/7.2-gluedatabrew/" title="Data preparation with Glue DataBrew" class="dd-item 
        
        
        
        ">
      <a href="/7-gluedatabrew/7.2-gluedatabrew/">
           <b> 6.2 </b> Data preparation with Glue DataBrew
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="http://awsstudygroup.com/"><i class='fab fa-aws'></i> AWS Study Group - Blog</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://www.facebook.com/groups/awsstudygroupfcj/"><i class='fab fa-facebook'></i> AWS Study Group - FB Group</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      
        <li>
          <a class="padding">
            <i class="fas fa-language fa-fw"></i>
          <div class="select-style">
            <select id="select-language" onchange="location = this.value;">
          
          
          
              
              
                  
                    
                    
                      <option id="en" value="http://baoandev.github.io/4-transformingdatawithglue/4.1-datavalidationandetl/" selected>English</option>
                    
                  
              
                  
              
          
              
              
                  
              
                  
                    
                    
                      <option id="vi" value="http://baoandev.github.io/vi/4-transformingdatawithglue/4.1-datavalidationandetl/">Tiếng Việt</option>
                    
                  
              
          
        </select>
        <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
          width="255px" height="255px" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255;" xml:space="preserve">
          <g>
            <g id="arrow-drop-down">
              <polygon points="0,63.75 127.5,191.25 255,63.75 		" />
            </g>
          </g>
        </svg>
        </div>
        </a>
        </li>
      
      
      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> Clear History</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      <left>
    
    <b> Workshop</b> <br>
    <img src="https://hitwebcounter.com/counter/counter.php?page=7920860&style=0038&nbdigits=9&type=page&initCount=0" title="Migrate" Alt="web counter" border="0" /></a> <br>
    <b> <a href="https://cloudjourney.awsstudygroup.com/">Cloud Journey</a></b> <br>
    <img src="https://hitwebcounter.com/counter/counter.php?page=7830807&style=0038&nbdigits=9&type=page&initCount=0" title="Total CLoud Journey" Alt="web counter" border="0" />

</left>
<left>
    <br>
    <br>
    <b> Last Updated </b> <br>
    <i><font color=orange>18-08-2024</font></i>
</left>
<left>
    <br>
    <br>
    <b> Team </b> <br>

    <i> 
        <a href="https://www.linkedin.com/in/an-thai-6a1b16316/"  style="color:orange">Bảo An </a>
    </i>
</left>

<script async defer src="https://buttons.github.io/buttons.js"></script>
    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/'>Data with AWS</a> > <a href='/4-transformingdatawithglue/'>Transforming data with Glue</a> > Data Validation and ETL
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li></li>
        <li><a href="#confirm-you-can-see-the-tables">Confirm you can see the tables</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Data Validation and ETL
            </h1>
          

        



	<h4 id="create-glue-crawler-for-initial-full-load-data">Create Glue Crawler for initial full load data</h4>
<ol>
<li>
<p>Navigate to the AWS Glue Console</p>
</li>
<li>
<p>On the AWS Glue menu, under &lsquo;Data Catalog&rsquo;, select Crawlers.
<img alt="Data Validation and ETL" src="/images/4.transformingdatawithglue/0002-transdata.png"></p>
</li>
<li>
<p>Click Create crawler.</p>
</li>
<li>
<p>Enter glue-lab-crawler as the crawler name for initial data load.</p>
</li>
<li>
<p>Optionally, enter the description. This should also be descriptive and easily recognized and Click Next.
<img alt="Data Validation and ETL" src="/images/4.transformingdatawithglue/0003-transdata.png"></p>
</li>
<li>
<p>Under Choose data sources and classifiers select Not yet and click Add a data source
<img alt="Data Validation and ETL" src="/images/4.transformingdatawithglue/0004-transdata.png"></p>
</li>
<li>
<p>On the Add a data store page, make the following selections:</p>
</li>
</ol>
<ul>
<li>For Data source, click the drop-down box and select S3.</li>
<li>For Location of S3 data, select In this account</li>
<li>For S3 path, browse to the target folder stored CSV files, e.g., s3://xxx-dmslabs3bucket-xxx/tickets/</li>
<li>Leave all other parameters as default</li>
<li>Click Add an S3 data source</li>
</ul>
<ol start="8">
<li>
<p>Click Next.
<img alt="Data Validation and ETL" src="/images/4.transformingdatawithglue/0005-transdata.png"></p>
</li>
<li>
<p>On the Configure security settings page, make the following selection:</p>
</li>
</ol>
<ul>
<li>Under Existing IAM role select <!-- raw HTML omitted -->-GlueLabRole-<!-- raw HTML omitted --> which is pre-created for you. For example “mod-3fccddd123456789-GlueLabRole-ZOQDII7JTBUM”</li>
</ul>
<ol start="10">
<li>
<p>Click Next.
<img alt="Data Validation and ETL" src="/images/4.transformingdatawithglue/0006-transdata.png"></p>
</li>
<li>
<p>On the Set output and scheduling, under Target database, click Add database which pops-up another tab.
<img alt="Data Validation and ETL" src="/images/4.transformingdatawithglue/0007-transdata.png"></p>
</li>
<li>
<p>Enter ticketdata as your database name and click Create database
<img alt="Data Validation and ETL" src="/images/4.transformingdatawithglue/0008-transdata.png"></p>
</li>
<li>
<p>Please get back to the Set output and scheduling page</p>
</li>
</ol>
<ul>
<li>Select Target database as &rsquo;ticketdata&rsquo;. Please use the refresh option right next to the dropdown to make sure that the new database we created is listing there.</li>
<li>For Prefix added to tables (optional), leave the field empty.</li>
<li>Under Crawler schedule as select the frequency as &lsquo;On demand&rsquo;</li>
<li>Click Next
<img alt="Data Validation and ETL" src="/images/4.transformingdatawithglue/0009-transdata.png"></li>
</ul>
<ol start="14">
<li>
<p>Review the information and click Create crawler. The crawler is now ready to run.</p>
</li>
<li>
<p>Execute the Crawler by clicking Run crawler button.
<img alt="Data Validation and ETL" src="/images/4.transformingdatawithglue/00010-transdata.png"></p>
</li>
</ol>
<p>Crawler will change status from &lsquo;Running&rsquo; to &lsquo;Stopping&rsquo;, wait until crawler comes back to &lsquo;Ready&rsquo; state (the process will take a few minutes), you can see that it has created 15 tables.
<img alt="Data Validation and ETL" src="/images/4.transformingdatawithglue/00011-transdata.png"></p>
<ol start="16">
<li>In the AWS Glue navigation pane, under Data Catalog click Databases → Tables. You can also click the ticketdata database to browse the tables.
<img alt="Data Validation and ETL" src="/images/4.transformingdatawithglue/00012-transdata.png"></li>
</ol>
<h4 id="data-validation-exercise">Data Validation Exercise</h4>
<ol>
<li>Within the Tables section of your ticketdata database, click the person table.</li>
</ol>
<p>You may have noticed that some tables (such as person) have column headers such as col0,col1,col2,col3. In absence of headers or when the crawler cannot determine the header type, default column headers are specified.</p>
<p>This exercise uses the person table in an example of how to resolve this issue.</p>
<ol start="2">
<li>
<p>Click Edit Schema option
<img alt="Data Validation and ETL" src="/images/4.transformingdatawithglue/00013-transdata.png"></p>
</li>
<li>
<p>In the Edit Schema section, select the row for col0 (column name) and click Edit.
<img alt="Data Validation and ETL" src="/images/4.transformingdatawithglue/00014-transdata.png"></p>
</li>
</ol>
<p>Type id as the column name and click Save.
<img alt="Data Validation and ETL" src="/images/4.transformingdatawithglue/00015-transdata.png">
<img alt="Data Validation and ETL" src="/images/4.transformingdatawithglue/00016-transdata.png"></p>
<p>Repeat the above steps to change the remaining column names to match those shown in the following figure: full_name, last_name and first_name.
<img alt="Data Validation and ETL" src="/images/4.transformingdatawithglue/00017-transdata.png"></p>
<ol start="4">
<li>Click Save as new table version.</li>
</ol>
<h4 id="data-etl-exercise">Data ETL Exercise</h4>
<p>Pre-requisite: To store processed data in parquet format, we need a new folder location for each table, eg. the full path for sport_team table look like this - s3://&lt;s3_bucket_name&gt;/tickets/dms_parquet/sport_team</p>
<p>Glue will create the new folder automatically, based on your input of the full file path, such as the example above. Please refer to the user guide  in terms of how to manually create a folder in S3 bucket.</p>
<ol>
<li>
<p>In the left navigation pane, click ETL jobs.</p>
</li>
<li>
<p>Click “Visual ETL”
<img alt="Data Validation and ETL" src="/images/4.transformingdatawithglue/00018-transdata.png"></p>
</li>
<li>
<p>Select Amazon S3 from the Sources list to add a Data source - S3 bucket node.
<img alt="Data Validation and ETL" src="/images/4.transformingdatawithglue/00019-transdata.png"></p>
</li>
<li>
<p>Select the Data source - S3 bucket node to show the data source properties.</p>
</li>
<li>
<p>In the panel on the right under “Data source properties - S3”, select Data Catalog table and choose the ticketdata database from the drop down. For Table, select the sport_team table.</p>
</li>
<li>
<p>Click on the + button and select Change Schema from the Transforms list to add a Transform - Change Schema node.
<img alt="Data Validation and ETL" src="/images/4.transformingdatawithglue/00020-transdata.png"></p>
</li>
<li>
<p>Select the Transform - Change Schema node to show the properties. In the Transform panel on the right, change the data type of id column to double in the dropdown.
<img alt="Data Validation and ETL" src="/images/4.transformingdatawithglue/00021-transdata.png"></p>
</li>
<li>
<p>Click on the + button and select Amazon S3 from the Targets list to add a Data target - S3 bucket node.
<img alt="Data Validation and ETL" src="/images/4.transformingdatawithglue/00022-transdata.png"></p>
</li>
<li>
<p>Select the Data target - S3 bucket node to show the properties. In the panel on the right, change the Format to Parquet in the dropdown. Under Compression Type, select Uncompressed from the dropdown.</p>
</li>
<li>
<p>Under “S3 Target Location”, select “Browse S3” browse to the “mod-xxx-dmslabs3bucket-xxx” bucket, select “tickets” item and press “Choose”.
<img alt="Data Validation and ETL" src="/images/4.transformingdatawithglue/00023-transdata.png"></p>
</li>
<li>
<p>In the textbox, append dms_parquet/sport_team/ to the S3 url. The path should look similar to s3://mod-xxx-dmslabs3bucket-xxx/tickets/dms_parquet/sport_team/ - don’t forget the / at the end. The job will automatically create the folder.
<img alt="Data Validation and ETL" src="/images/4.transformingdatawithglue/00024-transdata.png"></p>
</li>
<li>
<p>Finally, select the Job details tab at the top. Enter Glue-Lab-SportTeamParquet under Name.</p>
</li>
<li>
<p>For IAM Role, select the role named similar to mod-xxx-GlueLabRole-xxx.</p>
</li>
<li>
<p>Scroll down the page and under Job bookmark, select Disable in the drop down. You can try out the bookmark functionality later in this lab.
<img alt="Data Validation and ETL" src="/images/4.transformingdatawithglue/00025-transdata.png"></p>
</li>
<li>
<p>Press the Save button in the top right-hand corner to create the job.</p>
</li>
<li>
<p>Once you see the Successfully created job message in the banner, click the Run button to start the job.</p>
</li>
<li>
<p>Select Jobs from the navigation panel on the left-hand side to see a list of your jobs.</p>
</li>
<li>
<p>Select Monitoring from the navigation panel on the left-hand side to view your running jobs, success/failure rates and various other statistics.
<img alt="Data Validation and ETL" src="/images/4.transformingdatawithglue/00026-transdata.png"></p>
</li>
<li>
<p>Scroll down to the Job runs list to verify that the ETL job has completed successfully. This should take about 1 minute to complete.</p>
</li>
<li>
<p>We need to repeat this process for an additional 4 jobs, to transform the sport_location, sporting_event, sporting_event_ticket and person tables.</p>
</li>
</ol>
<p>During this process, we will need to modify different column data types. We can either repeat the process above for each table, or we can clone the first job and update the details. The steps below describe how to clone the job - if creating manually each time, follow the above steps but make sure you use the updated values from the tables below.</p>
<ol>
<li>
<p>Return to the Jobs menu, and select the Glue-Lab-SportsTeamParquet job by clicking the checkbox next to the name.
<img alt="Data Validation and ETL" src="/images/4.transformingdatawithglue/00027-transdata.png"></p>
</li>
<li>
<p>Under the Actions dropdown, select Clone job. Update the job as per the following tables, then Save and Run.</p>
</li>
</ol>
<ul>
<li>
<p>Sport_Location:</p>
<p>Create a Glue-Lab-SportLocationParquet job with the following attributes:</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>Task / Action</th>
<th>Attribute</th>
<th>Values</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Data source - S3 bucket</strong> node</td>
<td>Database</td>
<td>ticketdata</td>
</tr>
<tr>
<td></td>
<td>Table</td>
<td>sport_location</td>
</tr>
<tr>
<td><strong>Transform - ApplyMapping</strong> node</td>
<td>Schema transformations</td>
<td>None</td>
</tr>
<tr>
<td><strong>Data target - S3 bucket</strong> node</td>
<td>Format</td>
<td>Parquet</td>
</tr>
<tr>
<td></td>
<td>Compression Type</td>
<td>Uncompressed</td>
</tr>
<tr>
<td></td>
<td>S3 target path</td>
<td>tickets/dms_parquet/sport_location/</td>
</tr>
<tr>
<td><strong>Job details tab</strong></td>
<td>Job Name</td>
<td>Glue-Lab-SportLocationParquet</td>
</tr>
<tr>
<td></td>
<td>IAM Role</td>
<td>xxx-GlueLabRole-xxx</td>
</tr>
<tr>
<td></td>
<td>Job bookmark</td>
<td>Disable</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>Sporting_Event:</p>
<p>Create a Glue-Lab-SportingEventParquet job with the following attributes:</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>Task / Action</th>
<th>Attribute</th>
<th>Values</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Data source - S3 bucket</strong> node</td>
<td>Database</td>
<td>ticketdata</td>
</tr>
<tr>
<td></td>
<td>Table</td>
<td>sporting_event</td>
</tr>
<tr>
<td><strong>Transform - ApplyMapping</strong> node</td>
<td>Schema transformations</td>
<td>column “start_date_time” =&gt; TIMESTAMP</td>
</tr>
<tr>
<td></td>
<td></td>
<td>column “start_date” =&gt; DATE</td>
</tr>
<tr>
<td><strong>Data target - S3 bucket</strong> node</td>
<td>Format</td>
<td>Parquet</td>
</tr>
<tr>
<td></td>
<td>Compression Type</td>
<td>Uncompressed</td>
</tr>
<tr>
<td></td>
<td>S3 target path</td>
<td>tickets/dms_parquet/sporting_event/</td>
</tr>
<tr>
<td><strong>Job details tab</strong></td>
<td>Job Name</td>
<td>Glue-Lab-SportingEventParquet</td>
</tr>
<tr>
<td></td>
<td>IAM Role</td>
<td>xxx-GlueLabRole-xxx</td>
</tr>
<tr>
<td></td>
<td>Job bookmark</td>
<td>Disable</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>Sporting_Event_Ticket:</p>
<p>Create a Glue-Lab-SportingEventTicketParquet job with the following attributes:</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>Task / Action</th>
<th>Attribute</th>
<th>Values</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Data source - S3 bucket</strong> node</td>
<td>Database</td>
<td>ticketdata</td>
</tr>
<tr>
<td></td>
<td>Table</td>
<td>sporting_event_ticket</td>
</tr>
<tr>
<td><strong>Transform - ApplyMapping</strong> node</td>
<td>Schema transformations</td>
<td>column “id” =&gt; DOUBLE</td>
</tr>
<tr>
<td></td>
<td></td>
<td>column “sporting_event_id” =&gt; DOUBLE</td>
</tr>
<tr>
<td></td>
<td></td>
<td>column “ticketholder_id” =&gt; DOUBLE</td>
</tr>
<tr>
<td><strong>Data target - S3 bucket</strong> node</td>
<td>Format</td>
<td>Parquet</td>
</tr>
<tr>
<td></td>
<td>Compression Type</td>
<td>Uncompressed</td>
</tr>
<tr>
<td></td>
<td>S3 target path</td>
<td>tickets/dms_parquet/sporting_event_ticket/</td>
</tr>
<tr>
<td><strong>Job details tab</strong></td>
<td>Job Name</td>
<td>Glue-Lab-SportingEventTicketParquet</td>
</tr>
<tr>
<td></td>
<td>IAM Role</td>
<td>xxx-GlueLabRole-xxx</td>
</tr>
<tr>
<td></td>
<td>Job bookmark</td>
<td>Disable</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>Person</p>
<p>Create a Glue-Lab-PersonParquet job with the following attributes:</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>Task / Action</th>
<th>Attribute</th>
<th>Values</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Data source - S3 bucket</strong> node</td>
<td>Database</td>
<td>ticketdata</td>
</tr>
<tr>
<td></td>
<td>Table</td>
<td>person</td>
</tr>
<tr>
<td><strong>Transform - ApplyMapping</strong> node</td>
<td>Schema transformations</td>
<td>column “id” =&gt; DOUBLE</td>
</tr>
<tr>
<td><strong>Data target - S3 bucket</strong> node</td>
<td>Format</td>
<td>Parquet</td>
</tr>
<tr>
<td></td>
<td>Compression Type</td>
<td>Uncompressed</td>
</tr>
<tr>
<td></td>
<td>S3 target path</td>
<td>tickets/dms_parquet/person/</td>
</tr>
<tr>
<td><strong>Job details tab</strong></td>
<td>Job Name</td>
<td>Glue-Lab-PersonParquet</td>
</tr>
<tr>
<td></td>
<td>IAM Role</td>
<td>xxx-GlueLabRole-xxx</td>
</tr>
<tr>
<td></td>
<td>Job bookmark</td>
<td>Disable</td>
</tr>
</tbody>
</table>
<p><img alt="Data Validation and ETL" src="/images/4.transformingdatawithglue/00028-transdata.png"></p>
<h4 id="create-glue-crawler-for-parquet-files">Create Glue Crawler for Parquet Files</h4>
<ol>
<li>
<p>In the Glue navigation menu, under Data Catalog select Crawlers. Click Create crawler.
<img alt="Data Validation and ETL" src="/images/4.transformingdatawithglue/00029-transdata.png"></p>
</li>
<li>
<p>For Crawler name, type glue-lab-parquet-crawler and Click Next.
<img alt="Data Validation and ETL" src="/images/4.transformingdatawithglue/00030-transdata.png"></p>
</li>
<li>
<p>In the Add data store screen</p>
</li>
</ol>
<ul>
<li>For Choose a data store, select “S3”.</li>
<li>For Location of S3 data, select “In this account”.</li>
<li>For S3 path, specify the S3 Path (Parent Parquet folder) that contains the nested parquet files e.g., s3://xxx-dmslabs3bucket-xxx/tickets/dms_parquet/</li>
<li>Leave all other parameters as default</li>
<li>Click Add an S3 data source.
<img alt="Data Validation and ETL" src="/images/4.transformingdatawithglue/00031-transdata.png">
<img alt="Data Validation and ETL" src="/images/4.transformingdatawithglue/00032-transdata.png"></li>
</ul>
<ol start="4">
<li>In next screen Choose data sources and classifiers, click Next.</li>
<li>On the Configure security settings page, select Choose an existing IAM role.</li>
</ol>
<ul>
<li>For IAM role, select the existing role “xxx-GlueLabRole-xxx” and</li>
<li>Click Next.
<img alt="Data Validation and ETL" src="/images/4.transformingdatawithglue/00033-transdata.png"></li>
</ul>
<ol start="6">
<li>On the Set output and scheduling page,</li>
</ol>
<ul>
<li>Under Target database, choose your existing database which you created earlier e.g. ticketdata</li>
<li>For the Prefix added to tables (optional), type parquet_</li>
<li>For Crawler schedule select “On Demand” and Click Next.
<img alt="Data Validation and ETL" src="/images/4.transformingdatawithglue/00034-transdata.png"></li>
</ul>
<ol start="7">
<li>
<p>Review the summary page and click Create crawler.
<img alt="Data Validation and ETL" src="/images/4.transformingdatawithglue/00035-transdata.png"></p>
</li>
<li>
<p>Click Run Crawler. Once your crawler has finished running, you should see that that tables were added, depending on how many parquet ETL conversions you set up in the previous section.
<img alt="Data Validation and ETL" src="/images/4.transformingdatawithglue/00036-transdata.png">
<img alt="Data Validation and ETL" src="/images/4.transformingdatawithglue/00037-transdata.png"></p>
</li>
</ol>
<h3 id="confirm-you-can-see-the-tables">Confirm you can see the tables</h3>
<ol start="9">
<li>In the left navigation pane, click Tables.</li>
<li>Add the filter parquet for Classification to return the newly created tables.
<img alt="Data Validation and ETL" src="/images/4.transformingdatawithglue/00038-transdata.png"></li>
</ol>





<footer class=" footline" >
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/4-transformingdatawithglue/" title="Transforming data with Glue"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/5-queryandvisualize/" title="Query and Visualize" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1726578020"></script>
    <script src="/js/perfect-scrollbar.min.js?1726578020"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1726578020"></script>
    <script src="/js/jquery.sticky.js?1726578020"></script>
    <script src="/js/featherlight.min.js?1726578020"></script>
    <script src="/js/highlight.pack.js?1726578020"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1726578020"></script>
    <script src="/js/learn.js?1726578020"></script>
    <script src="/js/hugo-learn.js?1726578020"></script>

    <link href="/mermaid/mermaid.css?1726578020" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1726578020"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-158079754-2', 'auto');
  ga('send', 'pageview');

</script>
  </body>
</html>
